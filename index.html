<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- displays site properly based on user's device -->

    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./assets/images/favicon-32x32.png"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />

    <title>Frontend Mentor | Age calculator app</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="stylesheet" href="./css/queries.css" />

    <!-- Feel free to remove these styles or customise in your own stylesheet 👍 -->
    <style>
      .attribution {
        font-size: 11px;
        text-align: center;
      }
      .attribution a {
        color: hsl(228, 45%, 44%);
      }
    </style>
  </head>
  <body>
    <main>
      <div class="container">
        <form class="input__box">
          <div class="input__items">
            <label id="inputLabelDay" for="inputName" class="input__text"
              >Day</label
            >
            <input id="inputDay" class="input__item" placeholder="DD" />
            <span id="inputErrorDay" class="input__error__text"
              >Must be a valid day</span
            >
          </div>
          <div class="input__items">
            <label id="inputLabelMonth" for="inputName" class="input__text"
              >Month</label
            >
            <input id="inputMonth" class="input__item" placeholder="MM" />
            <span id="inputErrorMonth" class="input__error__text"
              >Must be a valid month</span
            >
          </div>
          <div class="input__items">
            <label id="inputLabelYear" for="inputName" class="input__text"
              >Year</label
            >
            <input id="inputYear" class="input__item" placeholder="YYYY" />
            <span id="inputErrorYear" class="input__error__text"
              >Must be in the past</span
            >
          </div>
        </form>
        <div class="img__icon__box">
          <img src="/assets/images/icon-arrow.svg" class="arrow__icon" />
        </div>
        <div class="result__box">
          <div class="result__items">
            <span id="outputYears" class="result__dash"> - - </span>
            <h2 class="result__item">years</h2>
          </div>
          <div class="result__items">
            <span id="outputMonths" class="result__dash"> - - </span>
            <h2 class="result__item">months</h2>
          </div>
          <div class="result__items">
            <span id="outputDays" class="result__dash"> - - </span>
            <h2 class="result__item">days</h2>
          </div>
        </div>
      </div>
    </main>
    <div class="attribution">
      Challenge by
      <a href="https://www.frontendmentor.io?ref=challenge" target="_blank"
        >Frontend Mentor</a
      >. Coded by <a href="#">Tovvy Dumaplin</a>.
    </div>
    <script>
      //Define
      let inputDay,
        inputMonth,
        inputYear,
        outputDays,
        outputMonths,
        outputYears,
        inputErrorDay,
        inputErrorMonth,
        inputErrorYear,
        inputLabelDay,
        inputLabelMonth,
        inputLabelYear;

      document.addEventListener("DOMContentLoaded", function () {
        inputDay = document.getElementById("inputDay");
        inputMonth = document.getElementById("inputMonth");
        inputYear = document.getElementById("inputYear");
        outputDays = document.getElementById("outputDays");
        outputMonths = document.getElementById("outputMonths");
        outputYears = document.getElementById("outputYears");
        inputErrorDay = document.getElementById("inputErrorDay");
        inputErrorMonth = document.getElementById("inputErrorMonth");
        inputErrorYear = document.getElementById("inputErrorYear");
        inputLabelDay = document.getElementById("inputLabelDay");
        inputLabelMonth = document.getElementById("inputLabelMonth");
        inputLabelYear = document.getElementById("inputLabelYear");

        // event listeners pang call the functions
        inputDay.addEventListener("input", function () {
          this.value = this.value.slice(0, 2);
          calculateAge();
          validation();
          numbersOnly(event);
        });
        inputMonth.addEventListener("input", function () {
          this.value = this.value.slice(0, 2);
          calculateAge();
          validation();
          numbersOnly(event);
        });
        inputYear.addEventListener("input", function () {
          this.value = this.value.slice(0, 4);
          calculateAge();
          validation();
          numbersOnly(event);
        });
      });

      // Functions
      function calculateAge() {
        // Parse ng input
        const day = parseInt(inputDay.value);
        const month = parseInt(inputMonth.value) - 1; // need mag lagay -1 kasi 0 based ang index ng month
        const year = parseInt(inputYear.value);

        // Validate input
        if (
          isNaN(day) ||
          isNaN(month) ||
          isNaN(year) ||
          day < 1 ||
          day > 31 ||
          month < 0 ||
          month > 11 ||
          year > new Date().getFullYear()
        ) {
          // Pag invalid yung input, iseset lang sa - - yung output.
          outputYears.innerText = "- -";
          outputMonths.innerText = "- -";
          outputDays.innerText = "- -";
          return; // Exit agad para di mag tuloy
        }

        const currentDate = new Date();

        // date object para sa user
        const birthDate = new Date(year, month, day);

        let ageInMilliseconds = currentDate - birthDate;
        let ageDate = new Date(ageInMilliseconds);

        // Extract years, months, and days from age
        let ageInYears = ageDate.getUTCFullYear() - 1970;
        let ageInMonths = ageDate.getUTCMonth();
        let ageInDays = ageDate.getUTCDate() - 1; // need negative 1 kasi nag i-start ang getdate ng 1

        // Output the age
        outputYears.innerText = ageInYears;
        outputMonths.innerText = ageInMonths;
        outputDays.innerText = ageInDays;
      }

      function validation() {
        if (parseInt(inputDay.value) > 31) {
          inputDay.style.borderColor = "var(--error-color)";
          inputLabelDay.style.color = "var(--error-color)";
          inputErrorDay.style.visibility = "visible";
        } else {
          inputDay.style.borderColor = "";
          inputLabelDay.style.color = "";
          inputErrorDay.style.visibility = "hidden";
        }

        if (parseInt(inputMonth.value) > 12) {
          inputMonth.style.borderColor = "red";
          inputLabelMonth.style.color = "var(--error-color)";
          inputErrorMonth.style.visibility = "visible";
        } else {
          inputMonth.style.borderColor = "";
          inputLabelMonth.style.color = "";
          inputErrorMonth.style.visibility = "hidden";
        }

        if (parseInt(inputYear.value) > new Date().getFullYear()) {
          inputYear.style.borderColor = "red";
          inputLabelYear.style.color = "var(--error-color)";
          inputErrorYear.style.visibility = "visible";
        } else {
          inputYear.style.borderColor = "";
          inputLabelYear.style.color = "";
          inputErrorYear.style.visibility = "hidden";
        }
      }
      // pang limit ng input
      function numbersOnly(event) {
        event.target.value = event.target.value.replace(/[^0-9]/g, "");
      }
    </script>
  </body>
</html>
